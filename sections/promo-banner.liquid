{% schema %}
{
  "name": "Promo Banner",
  "settings": [
    {
      "type": "text",
      "id": "banner_text",
      "label": "Banner Text",
      "default": "Limited time only! Sale up to 40% off"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    },
    {
      "type": "text",
      "id": "sale_end",
      "label": "Sale End Time (YYYY-MM-DDTHH:MM:SS)",
      "default": "2026-02-25T23:59:59"
    }
  ],
  "presets": [
    {
      "name": "Promo Banner"
    }
  ]
}
{% endschema %}
<div class="promo-banner" {% if section.settings.background_image %}style="background-image: url('{{ section.settings.background_image | image_url: width: 2000 }}');"{% endif %}>
  
  <div class="promo-left">
    <h2 class="promo-heading">{{ section.settings.banner_text }}</h2>
  </div>

  <div class="promo-right">
    <div class="countdown" data-endtime="{{ section.settings.sale_end }}"></div>
  </div>

</div>

<style>
.promo-banner {
  width: 100%;
  height: 250px;
  background-size: cover;
  background-position: center;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 60px;
  color: white;
  box-sizing: border-box;
}

/* Лівий контейнер */
.promo-left {
  text-align: left;
}

/* Правий контейнер */
.promo-right {
  text-align: right;
}

/* Heading */
.promo-heading {
  font-family: var(--font-heading-family);
  font-size: 32px;
  margin: 0;
  color: #ffffff;
}

.countdown {
  display: flex;
  align-items: center;
  gap: 10px;
  font-family: var(--font-body-family);
}

.time-block {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.time-number {
  font-size: 28px;
  font-weight: 600;
}

.time-label {
  font-size: 12px;
  margin-top: 4px;
  opacity: 0.8;
  text-transform: uppercase;
}

.time-separator {
  font-size: 26px;
  font-weight: 600;
  margin: 0 4px;
}
</style>

<script>
function startCountdown(element) {
  const endTime = new Date(element.dataset.endtime).getTime();

  function updateTimer() {
    const now = new Date().getTime();
    const distance = endTime - now;

    if (distance < 0) {
      element.innerHTML = "Sale ended";
      clearInterval(interval);
      return;
    }

    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    element.innerHTML = `
      <div class="time-block">
        <span class="time-number">${days}</span>
        <span class="time-label">Days</span>
      </div>
      <span class="time-separator">:</span>
      <div class="time-block">
        <span class="time-number">${hours}</span>
        <span class="time-label">Hours</span>
      </div>
      <span class="time-separator">:</span>
      <div class="time-block">
        <span class="time-number">${minutes}</span>
        <span class="time-label">Minutes</span>
      </div>
      <span class="time-separator">:</span>
      <div class="time-block">
        <span class="time-number">${seconds}</span>
        <span class="time-label">Seconds</span>
      </div>
    `;
  }

  updateTimer();
  const interval = setInterval(updateTimer, 1000);
}

document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.countdown').forEach(el => startCountdown(el));
});
</script>